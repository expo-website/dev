!function(){"use strict";function c(e){var n={};return e.forEach(function(e,t){Reflect.has(n,t)?(Array.isArray(n[t])||(n[t]=[n[t]]),n[t].push(e)):n[t]=e}),n}function t(e){e.preventDefault(),e=new FormData(e.target),e=c(e),window.MSFTPrivacy[a].trigger("QuestionsFormSubmitWithoutMetaData",{data:e})}function e(){var e,r=null!=(e=null==(e=window.msftData)?void 0:e.executionContexts)&&e.length?window.msftData.executionContexts:[];o.forEach(function(e){var t=e.selector,n=e.handler;document.querySelectorAll(t).forEach(function(e){if(0<r.length){var t=e.getAttributeNames();if(r.some(function(e){return t.includes("".concat(e,"-disabled"))}))return}n(e)})}),r.forEach(function(e){document.querySelectorAll("[".concat(e,"-hidden]")).forEach(function(e){e.remove()})})}function n(e){if(e.target&&"a"===e.target.nodeName.toLowerCase()){var t={},n=e.target.getAttributeNames();e.preventDefault(),e.stopPropagation();for(var r=0;r<n.length;r++){var o=n[r];t[o]=e.target.getAttribute(o)||""}window.MSFTPrivacy[a].trigger(i.AnchorTagClicked,{attributes:t})}}var i,r,a="webConsent",o=[{selector:"[msft-consent-accept-all]",handler:function(e){e.addEventListener("click",function(){window.MSFTPrivacy[a].trigger("AcceptAll"),window.MSFTPrivacy[a].trigger("CloseConsentNotice")})}},{selector:"[msft-consent-open-preferences]",handler:function(e){e.addEventListener("click",function(){window.MSFTPrivacy[a].trigger("ShowTemplate",{templateId:"Preferences"}),window.MSFTPrivacy[a].trigger("CloseConsentNotice")})}},{selector:"[msft-consent-decline-all]",handler:function(e){e.addEventListener("click",function(){window.MSFTPrivacy[a].trigger("RejectAll"),window.MSFTPrivacy[a].trigger("CloseConsentNotice")})}},{selector:"[msft-consent-save-preferences]",handler:function(e){e.addEventListener("click",function(){var e=document.querySelectorAll("[msft-consent-tracker-category]"),t={preferences:{}};e.forEach(function(e){t.preferences[e.getElementsByTagName("input")[0].id]=e.getElementsByTagName("input")[0].checked?"1":"0"}),window.MSFTPrivacy[a].trigger("UpdateConsent",{consent:t}),window.MSFTPrivacy[a].trigger("CloseTemplate",{templateId:"Preferences"}),window.MSFTPrivacy[a].trigger("CloseConsentNotice")})}},{selector:"[msft-consent-close-preferences]",handler:function(e){e.addEventListener("click",function(){window.MSFTPrivacy[a].trigger("CloseTemplate",{templateId:"Preferences"}),window.MSFTPrivacy[a].trigger("ShowConsentNotice")})}},{selector:"[msft-questionnaire-form]",handler:function(e){e.addEventListener("submit",t)}},{selector:"[msft-consent-open-page]",handler:function(e){var t=e.getAttribute("msft-consent-open-page");null!==t&&e.addEventListener("click",function(){window.MSFTPrivacy[a].trigger("ShowTemplate",{templateId:t})})}},{selector:"[msft-consent-close-page]",handler:function(e){var t=e.getAttribute("msft-consent-close-page");null!==t&&e.addEventListener("click",function(){window.MSFTPrivacy[a].trigger("CloseTemplate",{templateId:t})})}},{selector:"[msft-consent-trigger-event]",handler:function(o){var i=o.getAttribute("msft-consent-trigger-event");null!==i&&o.addEventListener("click",function(){if("toggle-driven"===i){var e=o.getAttribute("msft-consent-toggle-id");if(null===e)return;e=null==(e=document.getElementById(e))?void 0:e.checked;i=e?o.getAttribute("msft-consent-toggle-on-event"):o.getAttribute("msft-consent-toggle-off-event")}var e=o.getAttribute("msft-payload-data"),t=o.getAttribute("msft-payload-form-id"),n=o.getAttribute("msft-payload-input-ids"),r=null;null!==e?r=function(e){try{return JSON.parse(e)}catch(e){return null}}(e):null!==t?r=function(e){try{var t=document.getElementById(e);if(!t)return null;var n=new FormData(t);return c(n)}catch(e){return null}}(t):null!==n&&(r=function(e){try{var t=e.split(","),n={};return t.forEach(function(e){var t=document.getElementById(e);t&&(n[e]=t.value)}),n}catch(e){return null}}(n)),null!==i&&window.MSFTPrivacy[a].trigger(i,r)})}}],s=(window.disableQuestionFormSubmit=function(){document.querySelectorAll("[msft-questionnaire-form-submit]").forEach(function(e){e.setAttribute("disabled","")})},window.enableQuestionFormSubmit=function(){document.querySelectorAll("[msft-questionnaire-form-submit]").forEach(function(e){e.removeAttribute("disabled")})},"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",function(){e()}),null!=(r=window.msftData)&&r.renderTemplateWithoutIframe||(Promise.resolve().then(function(){return s}),Promise.resolve().then(function(){return g}).then(function(e){var r=e.callMethod,o=e.sendMessage;window.MSFTPrivacy=((e={})[a]={},e);["trigger","showChangeSettingsModal"].forEach(function(n){window.MSFTPrivacy[a][n]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o(n,e)}}),["getConsent","getTrackerCategories"].forEach(function(n){window.MSFTPrivacy[a][n]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r(n,e)}})})),(r=i=i||{}).ConsentChanged="ConsentChanged",r.ShowConsentNotice="ShowConsentNotice",r.ShowFirstPage="ShowFirstPage",r.CloseConsentNotice="CloseConsentNotice",r.AcceptAll="AcceptAll",r.RejectAll="RejectAll",r.ShowTemplate="ShowTemplate",r.CloseTemplate="CloseTemplate",r.UpdateConsent="UpdateConsent",r.AnchorTagClicked="AnchorTagClicked",r.FetchConfig="FetchConfig",r.QuestionsFormSubmitWithoutMetaData="QuestionsFormSubmitWithoutMetaData",r.QuestionsFormSubmit="QuestionsFormSubmit",r.ShowPreferences="ShowPreferences",r.ConsentPreference="MSFTConsentPreference",new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.forEach(function(e){"a"===e.nodeName.toLowerCase()&&e.addEventListener("click",{handleEvent:n})})})}).observe(document.documentElement,{childList:!0,subtree:!0}),Object.freeze({__proto__:null}));function l(){}l.deferred=function(){var n={};return n.promise=new Promise(function(e,t){n.resolve=e,n.reject=t}),n};function u(e,t,n){parent&&parent.postMessage({method:e,params:Object.values(t),responseId:n},msftData.origin)}var d=l,f={},g=(window.onmessage=function(e){var t;e.origin===msftData.origin&&null!=(t=null==e?void 0:e.data)&&t.responseId&&(e.data.error?f[e.data.responseId].reject(e.data.error):f[e.data.responseId].resolve(e.data.response))},Object.freeze({__proto__:null,sendMessage:u,callMethod:function(e,t){var n="".concat(e,"-").concat((new Date).getTime()),r=d.deferred();return f[n]=r,u(e,t,n),r.promise}}))}();
