!function(){"use strict";(t=n=n||{}).INIT_CONFIG="initConfig",t.DISCONNECT="disconnect",(t=e=e||{}).CONNECTED="connected",t.CLOSED="closed";var n,e,i="webConsent",t=(s.prototype.send=function(n){var e;null!=(e=this.source)&&e.postMessage(n,{targetOrigin:this.origin})},s.prototype.onMessageReceived=function(n){this.regExp.test(n.origin)?(this.source=this.source||n.source,this.origin=this.origin||n.origin,this.callback(n.data)):window.__MSFT_SDK[i].Logger.warn("Received invalid origin '".concat(n.origin,"'. Skipping execution."))},s.prototype.listen=function(){var e=this;window.addEventListener("message",function(n){e.onMessageReceived(n)})},s);function s(n){this.source=null,this.origin="",this.regExp=new RegExp("^https://privacy.(ci|ms|canary).ext.web.purview.azure(-test){0,1}.com$"),this.callback=n,this.listen()}c.send=function(n){c.messengerPlugin.send(n)},c.listen=function(n,e){c.callbacksMap[n]=c.callbacksMap[n]||[],c.callbacksMap[n].push(e)},c.getMessengerPlugin=function(){return c.messengerPlugin},c.onMessage=function(n){var e=n.event,i=n.value;null!=(n=c.callbacksMap[e])&&n.forEach(function(n){return n(i)})},c.callbacksMap={},c.messengerPlugin=new t(c.onMessage);var o=c;function c(){}(t={})[e.CONNECTED]=function(){o.send({event:e.CONNECTED})},t[e.CLOSED]=function(){o.send({event:e.CLOSED})};var a=t,r=((t={})[n.INIT_CONFIG]=function(n){window.__MSFT_SDK[i].initConsent(n),a.connected()},t[n.DISCONNECT]=function(){window.close()},t);Object.keys(r).forEach(function(n){o.listen(n,r[n])});window.addEventListener("beforeunload",function(){a.closed()},!1)}();
