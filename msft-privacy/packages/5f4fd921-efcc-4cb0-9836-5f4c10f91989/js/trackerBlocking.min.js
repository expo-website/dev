(function () {
    'use strict';

    var ConsentModelType;
    (function (ConsentModelType) {
        ConsentModelType["Explicit"] = "Explicit";
        ConsentModelType["Implicit"] = "Implicit";
    })(ConsentModelType || (ConsentModelType = {}));
    var PublicEvents;
    (function (PublicEvents) {
        PublicEvents["ConsentChanged"] = "ConsentChanged";
        PublicEvents["ShowConsentNotice"] = "ShowConsentNotice";
        PublicEvents["ShowFirstPage"] = "ShowFirstPage";
        PublicEvents["CloseConsentNotice"] = "CloseConsentNotice";
        PublicEvents["AcceptAll"] = "AcceptAll";
        PublicEvents["RejectAll"] = "RejectAll";
        PublicEvents["ShowTemplate"] = "ShowTemplate";
        PublicEvents["CloseTemplate"] = "CloseTemplate";
        PublicEvents["UpdateConsent"] = "UpdateConsent";
        PublicEvents["AnchorTagClicked"] = "AnchorTagClicked";
        PublicEvents["FetchConfig"] = "FetchConfig";
        PublicEvents["QuestionsFormSubmitWithoutMetaData"] = "QuestionsFormSubmitWithoutMetaData";
        PublicEvents["QuestionsFormSubmit"] = "QuestionsFormSubmit";
        PublicEvents["ShowPreferences"] = "ShowPreferences";
        PublicEvents["ConsentPreference"] = "MSFTConsentPreference";
    })(PublicEvents || (PublicEvents = {}));
    var Events;
    (function (Events) {
        Events["Init"] = "Init";
        Events["CoreConsentModelSelected"] = "CoreConsentModelSelected";
        Events["ConfigReady"] = "ConfigReady";
    })(Events || (Events = {}));
    var SDKMode;
    (function (SDKMode) {
        SDKMode["Default"] = "Default";
        SDKMode["HeadLess"] = "HeadLess";
    })(SDKMode || (SDKMode = {}));
    var StyleType;
    (function (StyleType) {
        StyleType["Url"] = "Url";
        StyleType["Text"] = "Text";
    })(StyleType || (StyleType = {}));
    var Preference;
    (function (Preference) {
        Preference["OFF"] = "0";
        Preference["ON"] = "1";
    })(Preference || (Preference = {}));
    var Cookie;
    (function (Cookie) {
        Cookie["Consent"] = "msft-consent";
    })(Cookie || (Cookie = {}));
    var RegisteredDivType;
    (function (RegisteredDivType) {
        RegisteredDivType["Script"] = "script";
        RegisteredDivType["IFrame"] = "iframe";
    })(RegisteredDivType || (RegisteredDivType = {}));
    var NoticeType;
    (function (NoticeType) {
        NoticeType["TrackerCategory"] = "trackerCategory";
        NoticeType["Questions"] = "Questions";
    })(NoticeType || (NoticeType = {}));
    var ErrorStrings;
    (function (ErrorStrings) {
        ErrorStrings["TemplateError"] = "<b>There is something wrong with template. Please check logs.</b>";
    })(ErrorStrings || (ErrorStrings = {}));
    var IntervalUnits;
    (function (IntervalUnits) {
        IntervalUnits["day"] = "day";
        IntervalUnits["week"] = "week";
        IntervalUnits["month"] = "month";
        IntervalUnits["year"] = "year";
    })(IntervalUnits || (IntervalUnits = {}));
    var QuestionType;
    (function (QuestionType) {
        QuestionType["Text"] = "Text";
        QuestionType["Email"] = "Email";
        QuestionType["Radio"] = "Radio";
        QuestionType["MultiSelect"] = "MultiSelect";
        QuestionType["Select"] = "Select";
        QuestionType["Date"] = "Date";
        QuestionType["PhoneNumber"] = "PhoneNumber";
        QuestionType["CreditCard"] = "CreditCard";
        QuestionType["Number"] = "Number";
        QuestionType["MultiLineText"] = "multiLineText";
    })(QuestionType || (QuestionType = {}));
    var QuestionValidation;
    (function (QuestionValidation) {
        QuestionValidation["Required"] = "Required";
    })(QuestionValidation || (QuestionValidation = {}));
    var QuestionField;
    (function (QuestionField) {
        QuestionField["Question"] = "question";
        QuestionField["Placeholder"] = "placeholder";
        QuestionField["Options"] = "options";
    })(QuestionField || (QuestionField = {}));
    var ModelKind;
    (function (ModelKind) {
        ModelKind["WebConsentModel"] = "WebConsentModel";
        ModelKind["QuestionModel"] = "DSRSubmissionModel";
    })(ModelKind || (ModelKind = {}));
    var PackageKind;
    (function (PackageKind) {
        PackageKind["WebConsentPackage"] = "WebConsentPackage";
        PackageKind["FIDESPackage"] = "FIDESPackage";
        PackageKind["DSRSubmissionPackage"] = "DSRSubmissionPackage";
    })(PackageKind || (PackageKind = {}));
    var Template;
    (function (Template) {
        Template["Preferences"] = "Preferences";
    })(Template || (Template = {}));

    var BlockingServiceUtil = /** @class */ (function () {
        function BlockingServiceUtil() {
        }
        BlockingServiceUtil.shouldBlockTrackerSource = function (categories) {
            // Check for 'isEssential !== true' means if category is non-essential or unknown then block it.
            return Boolean(categories === null || categories === void 0 ? void 0 : categories.split(',').some(function (category) {
                var trackerCategory = window.__MSFT_SDK.Store.getters.applicableTrackerCategories.find(function (_a) {
                    var categoryName = _a.categoryName;
                    return categoryName === category;
                });
                // Block any unknown category
                return trackerCategory
                    ? trackerCategory.isEssential !== true
                    : window.__MSFT_SDK.Store.getters.packageConfigurations
                        .isUnknownTagBlockingEnabled;
            }));
        };
        BlockingServiceUtil.shouldUnblockTrackerSource = function (categories) {
            return Boolean(categories === null || categories === void 0 ? void 0 : categories.split(',').every(function (category) {
                var _a;
                return ((_a = window.__MSFT_SDK.Store.getters.userConsent) === null || _a === void 0 ? void 0 : _a.preferences[category]) === Preference.ON;
            }));
        };
        BlockingServiceUtil.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE = 'text/blocked';
        BlockingServiceUtil.MSFT_CONSENT_CATEGORIES_ATTRIBUTE = 'msft-consent-categories';
        BlockingServiceUtil.MSFT_TRACKER_EXECUTION_ATTRIBUTE = 'msft-tracker-executed';
        BlockingServiceUtil.SRC_ATTRIBUTE = 'src';
        BlockingServiceUtil.DATASET_SRC_ATTRIBUTE = 'data-src';
        BlockingServiceUtil.SCRIPT_TYPE_ATTRIBUTE = 'type';
        BlockingServiceUtil.MSFT_POST_CONSENT_SCRIPT_TYPE_ATTRIBUTE = 'msft-post-consent-type';
        BlockingServiceUtil.MSFT_CONSENT_IGNORE_ATTRIBUTE = 'msft-ignore-consent';
        return BlockingServiceUtil;
    }());

    var BlockingService = /** @class */ (function () {
        function BlockingService() {
            this.domObserver = null;
        }
        BlockingService.mutationCallback = function (mutationRecords) {
            mutationRecords.forEach(function (mutationRecord) {
                mutationRecord.addedNodes.forEach(function (addedNode) {
                    try {
                        if (addedNode.nodeType === 1 &&
                            addedNode.hasAttribute(BlockingServiceUtil.MSFT_CONSENT_IGNORE_ATTRIBUTE) === false) {
                            if (addedNode.nodeName.toLowerCase() ===
                                window.__MSFT_SDK.enums.RegisteredDivType.Script) {
                                BlockingService.scriptMutationObserver(addedNode);
                            }
                            else if (addedNode.nodeName.toLowerCase() ===
                                window.__MSFT_SDK.enums.RegisteredDivType.IFrame) {
                                BlockingService.iframeMutationObserver(addedNode);
                            }
                        }
                    }
                    catch (error) {
                        console.warn('Failed to block the node ', addedNode.nodeName, 'with error ', error);
                        window.__MSFT_SDK.Logger.warn('Failed to block tag ' + addedNode.nodeName);
                    }
                });
            });
        };
        BlockingService.scriptMutationObserver = function (scriptNode) {
            var type = scriptNode.type;
            var msftConsentCategories = scriptNode.getAttribute(BlockingServiceUtil.MSFT_CONSENT_CATEGORIES_ATTRIBUTE);
            if (BlockingServiceUtil.shouldBlockTrackerSource(msftConsentCategories)) {
                window.__MSFT_SDK.Logger.info('Blocking script ' + scriptNode.src);
                if (!scriptNode.hasAttribute(BlockingServiceUtil.MSFT_TRACKER_EXECUTION_ATTRIBUTE)) {
                    scriptNode.setAttribute(BlockingServiceUtil.MSFT_POST_CONSENT_SCRIPT_TYPE_ATTRIBUTE, type);
                    scriptNode.setAttribute(BlockingServiceUtil.SCRIPT_TYPE_ATTRIBUTE, BlockingServiceUtil.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE);
                }
            }
            // Firefox has this additional event which prevents scripts from being executed
            var beforeScriptExecuteListener = function (event) {
                // Prevent only marked scripts from executing
                if (scriptNode.getAttribute(BlockingServiceUtil.SCRIPT_TYPE_ATTRIBUTE) ===
                    BlockingServiceUtil.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE)
                    event.preventDefault();
                scriptNode.removeEventListener('beforescriptexecute', beforeScriptExecuteListener);
            };
            scriptNode.addEventListener('beforescriptexecute', beforeScriptExecuteListener);
        };
        BlockingService.iframeMutationObserver = function (iframeNode) {
            var src = iframeNode.src;
            var msftConsentCategories = iframeNode.getAttribute(BlockingServiceUtil.MSFT_CONSENT_CATEGORIES_ATTRIBUTE);
            if (BlockingServiceUtil.shouldBlockTrackerSource(msftConsentCategories)) {
                window.__MSFT_SDK.Logger.info('Blocking iframe ' + iframeNode.src);
                iframeNode.removeAttribute(BlockingServiceUtil.SRC_ATTRIBUTE);
                iframeNode.setAttribute(BlockingServiceUtil.DATASET_SRC_ATTRIBUTE, src);
            }
        };
        BlockingService.unblock = function () {
            window.__MSFT_SDK.Logger.info('Tracker Blocking unblock is started');
            BlockingService.unblockScripts();
            BlockingService.unblockIFrames();
        };
        BlockingService.unblockScripts = function () {
            document
                .querySelectorAll("script[".concat(BlockingServiceUtil.MSFT_CONSENT_CATEGORIES_ATTRIBUTE, "][").concat(BlockingServiceUtil.SCRIPT_TYPE_ATTRIBUTE, "=\"").concat(BlockingServiceUtil.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE, "\"]:not([").concat(BlockingServiceUtil.MSFT_CONSENT_CATEGORIES_ATTRIBUTE, "=\"\"])"))
                .forEach(function (blockedNode) {
                var scriptNode = blockedNode;
                try {
                    var consentCategories = scriptNode.getAttribute(BlockingServiceUtil.MSFT_CONSENT_CATEGORIES_ATTRIBUTE);
                    var shouldUnblockTrackerSource = BlockingServiceUtil.shouldUnblockTrackerSource(consentCategories);
                    if (shouldUnblockTrackerSource) {
                        window.__MSFT_SDK.Logger.info('Unblocking script ' + scriptNode.src);
                        var typeValue = scriptNode.getAttribute(BlockingServiceUtil.MSFT_POST_CONSENT_SCRIPT_TYPE_ATTRIBUTE);
                        typeValue =
                            typeValue != null ? typeValue : 'application/javascript';
                        var parentNode = scriptNode.parentNode;
                        parentNode === null || parentNode === void 0 ? void 0 : parentNode.removeChild(scriptNode);
                        var newNode = document.createElement('script');
                        for (var i = 0; i < scriptNode.attributes.length; i++) {
                            var attribute = scriptNode.attributes[i];
                            if (attribute.name !== 'type') {
                                newNode.setAttribute(attribute.name, scriptNode.attributes[i].value);
                            }
                            else {
                                newNode.setAttribute(BlockingServiceUtil.SCRIPT_TYPE_ATTRIBUTE, typeValue);
                            }
                        }
                        newNode.setAttribute(BlockingServiceUtil.MSFT_TRACKER_EXECUTION_ATTRIBUTE, 'true');
                        newNode.appendChild(document.createTextNode(scriptNode.innerHTML));
                        parentNode == null
                            ? document.head.appendChild(newNode)
                            : parentNode.appendChild(newNode);
                    }
                    else {
                        window.__MSFT_SDK.Logger.info("Not Unblocking script ".concat(scriptNode.src, " as consent not given"));
                    }
                }
                catch (error) {
                    window.__MSFT_SDK.Logger.info("Failed to unblock script ".concat(scriptNode.src));
                }
            });
        };
        BlockingService.unblockIFrames = function () {
            document
                .querySelectorAll("iframe[".concat(BlockingServiceUtil.MSFT_CONSENT_CATEGORIES_ATTRIBUTE, "][").concat(BlockingServiceUtil.DATASET_SRC_ATTRIBUTE, "]:not([").concat(BlockingServiceUtil.MSFT_CONSENT_CATEGORIES_ATTRIBUTE, "=\"\"][").concat(BlockingServiceUtil.DATASET_SRC_ATTRIBUTE, "=\"\"])"))
                .forEach(function (blockedNode) {
                var iframeNode = blockedNode;
                try {
                    var consentCategories = iframeNode.getAttribute(BlockingServiceUtil.MSFT_CONSENT_CATEGORIES_ATTRIBUTE);
                    var shouldUnblockTrackerSource = BlockingServiceUtil.shouldUnblockTrackerSource(consentCategories);
                    if (shouldUnblockTrackerSource) {
                        window.__MSFT_SDK.Logger.info('Unblocking iframe ' + iframeNode.src);
                        var parentNode = iframeNode.parentNode;
                        parentNode === null || parentNode === void 0 ? void 0 : parentNode.removeChild(iframeNode);
                        var newNode = iframeNode.cloneNode(true);
                        var datasrc = newNode.getAttribute(BlockingServiceUtil.DATASET_SRC_ATTRIBUTE);
                        datasrc = datasrc !== null ? datasrc : '';
                        newNode.setAttribute(BlockingServiceUtil.SRC_ATTRIBUTE, datasrc);
                        newNode.setAttribute(BlockingServiceUtil.MSFT_TRACKER_EXECUTION_ATTRIBUTE, 'true');
                        newNode.removeAttribute(BlockingServiceUtil.DATASET_SRC_ATTRIBUTE);
                        parentNode == null
                            ? document.head.appendChild(newNode)
                            : parentNode.appendChild(newNode);
                    }
                    else {
                        window.__MSFT_SDK.Logger.info("Not Unblocking iframe ".concat(iframeNode.src, " as consent not given"));
                    }
                }
                catch (error) {
                    window.__MSFT_SDK.Logger.info("Failed to unblock iframe ".concat(iframeNode.src));
                }
            });
        };
        BlockingService.prototype.start = function (enableMutationObserver) {
            window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.ConsentChanged, BlockingService.unblock);
            this.domObserver = null;
            if (enableMutationObserver) {
                this.domObserver = new MutationObserver(function (mutationRecords) {
                    return BlockingService.mutationCallback(mutationRecords);
                });
                this.domObserver.observe(document.documentElement, {
                    childList: true,
                    subtree: true,
                });
                window.__MSFT_SDK.Logger.info('Started tracker blocking service');
            }
        };
        return BlockingService;
    }());
    var BlockingServiceInstance = new BlockingService();

    var PublicAPI = /** @class */ (function () {
        function PublicAPI() {
        }
        PublicAPI.getBlockingService = function () {
            return BlockingServiceInstance;
        };
        return PublicAPI;
    }());

    var _a;
    window.__MSFT_SDK.Helpers.AddPublicApis(PublicAPI);
    window.__MSFT_SDK.Helpers.exposeApis();
    if ((_a = window.__MSFT_SDK.Store.getters.packageConfigurations
        .isTrackerBlockingEnabled) !== null && _a !== void 0 ? _a : true) {
        PublicAPI.getBlockingService().start(true);
    }

}());
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhY2tlckJsb2NraW5nLm1pbi5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vU0RLL3NyYy9jb3JlL2NvbnN0YW50cy9lbnVtcy50cyIsIi4uLy4uLy4uLy4uLy4uL1NESy9zcmMvdHJhY2tlckJsb2NraW5nL0Jsb2NraW5nU2VydmljZVV0aWwudHMiLCIuLi8uLi8uLi8uLi8uLi9TREsvc3JjL3RyYWNrZXJCbG9ja2luZy9CbG9ja2luZ1NlcnZpY2UudHMiLCIuLi8uLi8uLi8uLi8uLi9TREsvc3JjL3RyYWNrZXJCbG9ja2luZy9wdWJsaWNBcGkvaW5kZXgudHMiLCIuLi8uLi8uLi8uLi8uLi9TREsvc3JjL3RyYWNrZXJCbG9ja2luZy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZW51bSBDb25zZW50TW9kZWxUeXBlIHtcclxuICBFeHBsaWNpdCA9ICdFeHBsaWNpdCcsXHJcbiAgSW1wbGljaXQgPSAnSW1wbGljaXQnLFxyXG59XHJcblxyXG5leHBvcnQgZW51bSBQdWJsaWNFdmVudHMge1xyXG4gIENvbnNlbnRDaGFuZ2VkID0gJ0NvbnNlbnRDaGFuZ2VkJyxcclxuICBTaG93Q29uc2VudE5vdGljZSA9ICdTaG93Q29uc2VudE5vdGljZScsXHJcbiAgU2hvd0ZpcnN0UGFnZSA9ICdTaG93Rmlyc3RQYWdlJyxcclxuICBDbG9zZUNvbnNlbnROb3RpY2UgPSAnQ2xvc2VDb25zZW50Tm90aWNlJyxcclxuICBBY2NlcHRBbGwgPSAnQWNjZXB0QWxsJyxcclxuICBSZWplY3RBbGwgPSAnUmVqZWN0QWxsJyxcclxuICBTaG93VGVtcGxhdGUgPSAnU2hvd1RlbXBsYXRlJyxcclxuICBDbG9zZVRlbXBsYXRlID0gJ0Nsb3NlVGVtcGxhdGUnLFxyXG4gIFVwZGF0ZUNvbnNlbnQgPSAnVXBkYXRlQ29uc2VudCcsXHJcbiAgQW5jaG9yVGFnQ2xpY2tlZCA9ICdBbmNob3JUYWdDbGlja2VkJyxcclxuICBGZXRjaENvbmZpZyA9ICdGZXRjaENvbmZpZycsXHJcbiAgUXVlc3Rpb25zRm9ybVN1Ym1pdFdpdGhvdXRNZXRhRGF0YSA9ICdRdWVzdGlvbnNGb3JtU3VibWl0V2l0aG91dE1ldGFEYXRhJyxcclxuICBRdWVzdGlvbnNGb3JtU3VibWl0ID0gJ1F1ZXN0aW9uc0Zvcm1TdWJtaXQnLFxyXG4gIFNob3dQcmVmZXJlbmNlcyA9ICdTaG93UHJlZmVyZW5jZXMnLFxyXG4gIENvbnNlbnRQcmVmZXJlbmNlID0gJ01TRlRDb25zZW50UHJlZmVyZW5jZScsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIEV2ZW50cyB7XHJcbiAgSW5pdCA9ICdJbml0JyxcclxuICBDb3JlQ29uc2VudE1vZGVsU2VsZWN0ZWQgPSAnQ29yZUNvbnNlbnRNb2RlbFNlbGVjdGVkJyxcclxuICBDb25maWdSZWFkeSA9ICdDb25maWdSZWFkeScsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIFNES01vZGUge1xyXG4gIERlZmF1bHQgPSAnRGVmYXVsdCcsXHJcbiAgSGVhZExlc3MgPSAnSGVhZExlc3MnLFxyXG59XHJcblxyXG5leHBvcnQgZW51bSBTdHlsZVR5cGUge1xyXG4gIFVybCA9ICdVcmwnLFxyXG4gIFRleHQgPSAnVGV4dCcsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIFByZWZlcmVuY2Uge1xyXG4gIE9GRiA9ICcwJyxcclxuICBPTiA9ICcxJyxcclxufVxyXG5cclxuZXhwb3J0IGVudW0gQ29va2llIHtcclxuICBDb25zZW50ID0gJ21zZnQtY29uc2VudCcsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIFJlZ2lzdGVyZWREaXZUeXBlIHtcclxuICBTY3JpcHQgPSAnc2NyaXB0JyxcclxuICBJRnJhbWUgPSAnaWZyYW1lJyxcclxufVxyXG5cclxuZXhwb3J0IGVudW0gTm90aWNlVHlwZSB7XHJcbiAgVHJhY2tlckNhdGVnb3J5ID0gJ3RyYWNrZXJDYXRlZ29yeScsXHJcbiAgUXVlc3Rpb25zID0gJ1F1ZXN0aW9ucycsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIEVycm9yU3RyaW5ncyB7XHJcbiAgVGVtcGxhdGVFcnJvciA9ICc8Yj5UaGVyZSBpcyBzb21ldGhpbmcgd3Jvbmcgd2l0aCB0ZW1wbGF0ZS4gUGxlYXNlIGNoZWNrIGxvZ3MuPC9iPicsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIEludGVydmFsVW5pdHMge1xyXG4gIGRheSA9ICdkYXknLFxyXG4gIHdlZWsgPSAnd2VlaycsXHJcbiAgbW9udGggPSAnbW9udGgnLFxyXG4gIHllYXIgPSAneWVhcicsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIFF1ZXN0aW9uVHlwZSB7XHJcbiAgVGV4dCA9ICdUZXh0JyxcclxuICBFbWFpbCA9ICdFbWFpbCcsXHJcbiAgUmFkaW8gPSAnUmFkaW8nLFxyXG4gIE11bHRpU2VsZWN0ID0gJ011bHRpU2VsZWN0JyxcclxuICBTZWxlY3QgPSAnU2VsZWN0JyxcclxuICBEYXRlID0gJ0RhdGUnLFxyXG4gIFBob25lTnVtYmVyID0gJ1Bob25lTnVtYmVyJyxcclxuICBDcmVkaXRDYXJkID0gJ0NyZWRpdENhcmQnLFxyXG4gIE51bWJlciA9ICdOdW1iZXInLFxyXG4gIE11bHRpTGluZVRleHQgPSAnbXVsdGlMaW5lVGV4dCcsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIFF1ZXN0aW9uVmFsaWRhdGlvbiB7XHJcbiAgUmVxdWlyZWQgPSAnUmVxdWlyZWQnLFxyXG59XHJcblxyXG5leHBvcnQgZW51bSBRdWVzdGlvbkZpZWxkIHtcclxuICBRdWVzdGlvbiA9ICdxdWVzdGlvbicsXHJcbiAgUGxhY2Vob2xkZXIgPSAncGxhY2Vob2xkZXInLFxyXG4gIE9wdGlvbnMgPSAnb3B0aW9ucycsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIE1vZGVsS2luZCB7XHJcbiAgV2ViQ29uc2VudE1vZGVsID0gJ1dlYkNvbnNlbnRNb2RlbCcsXHJcbiAgUXVlc3Rpb25Nb2RlbCA9ICdEU1JTdWJtaXNzaW9uTW9kZWwnLFxyXG59XHJcblxyXG5leHBvcnQgZW51bSBQYWNrYWdlS2luZCB7XHJcbiAgV2ViQ29uc2VudFBhY2thZ2UgPSAnV2ViQ29uc2VudFBhY2thZ2UnLFxyXG4gIEZJREVTUGFja2FnZSA9ICdGSURFU1BhY2thZ2UnLFxyXG4gIERTUlN1Ym1pc3Npb25QYWNrYWdlID0gJ0RTUlN1Ym1pc3Npb25QYWNrYWdlJyxcclxufVxyXG5cclxuZXhwb3J0IGVudW0gVGVtcGxhdGUge1xyXG4gIFByZWZlcmVuY2VzID0gJ1ByZWZlcmVuY2VzJyxcclxufVxyXG4iLCJpbXBvcnQgeyBQcmVmZXJlbmNlIH0gZnJvbSAnY29yZS9jb25zdGFudHMvZW51bXMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIEJsb2NraW5nU2VydmljZVV0aWwge1xyXG4gIHB1YmxpYyBzdGF0aWMgU0NSSVBUX0JMT0NLSU5HX1RZUEVfQVRUUklCVVRFX1ZBTFVFID0gJ3RleHQvYmxvY2tlZCc7XHJcbiAgcHVibGljIHN0YXRpYyBNU0ZUX0NPTlNFTlRfQ0FURUdPUklFU19BVFRSSUJVVEUgPSAnbXNmdC1jb25zZW50LWNhdGVnb3JpZXMnO1xyXG4gIHB1YmxpYyBzdGF0aWMgTVNGVF9UUkFDS0VSX0VYRUNVVElPTl9BVFRSSUJVVEUgPSAnbXNmdC10cmFja2VyLWV4ZWN1dGVkJztcclxuICBwdWJsaWMgc3RhdGljIFNSQ19BVFRSSUJVVEUgPSAnc3JjJztcclxuICBwdWJsaWMgc3RhdGljIERBVEFTRVRfU1JDX0FUVFJJQlVURSA9ICdkYXRhLXNyYyc7XHJcbiAgcHVibGljIHN0YXRpYyBTQ1JJUFRfVFlQRV9BVFRSSUJVVEUgPSAndHlwZSc7XHJcbiAgcHVibGljIHN0YXRpYyBNU0ZUX1BPU1RfQ09OU0VOVF9TQ1JJUFRfVFlQRV9BVFRSSUJVVEUgPVxyXG4gICAgJ21zZnQtcG9zdC1jb25zZW50LXR5cGUnO1xyXG4gIHB1YmxpYyBzdGF0aWMgTVNGVF9DT05TRU5UX0lHTk9SRV9BVFRSSUJVVEUgPSAnbXNmdC1pZ25vcmUtY29uc2VudCc7XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgc2hvdWxkQmxvY2tUcmFja2VyU291cmNlKGNhdGVnb3JpZXM6IHN0cmluZyB8IG51bGwpOiBib29sZWFuIHtcclxuICAgIC8vIENoZWNrIGZvciAnaXNFc3NlbnRpYWwgIT09IHRydWUnIG1lYW5zIGlmIGNhdGVnb3J5IGlzIG5vbi1lc3NlbnRpYWwgb3IgdW5rbm93biB0aGVuIGJsb2NrIGl0LlxyXG5cclxuICAgIHJldHVybiBCb29sZWFuKFxyXG4gICAgICBjYXRlZ29yaWVzPy5zcGxpdCgnLCcpLnNvbWUoY2F0ZWdvcnkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHRyYWNrZXJDYXRlZ29yeSA9XHJcbiAgICAgICAgICB3aW5kb3cuX19NU0ZUX1NESy5TdG9yZS5nZXR0ZXJzLmFwcGxpY2FibGVUcmFja2VyQ2F0ZWdvcmllcy5maW5kKFxyXG4gICAgICAgICAgICAoeyBjYXRlZ29yeU5hbWUgfSkgPT4gY2F0ZWdvcnlOYW1lID09PSBjYXRlZ29yeSxcclxuICAgICAgICAgICk7XHJcblxyXG4gICAgICAgIC8vIEJsb2NrIGFueSB1bmtub3duIGNhdGVnb3J5XHJcbiAgICAgICAgcmV0dXJuIHRyYWNrZXJDYXRlZ29yeVxyXG4gICAgICAgICAgPyB0cmFja2VyQ2F0ZWdvcnkuaXNFc3NlbnRpYWwgIT09IHRydWVcclxuICAgICAgICAgIDogd2luZG93Ll9fTVNGVF9TREsuU3RvcmUuZ2V0dGVycy5wYWNrYWdlQ29uZmlndXJhdGlvbnNcclxuICAgICAgICAgICAgICAuaXNVbmtub3duVGFnQmxvY2tpbmdFbmFibGVkO1xyXG4gICAgICB9KSxcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIHNob3VsZFVuYmxvY2tUcmFja2VyU291cmNlKGNhdGVnb3JpZXM6IHN0cmluZyB8IG51bGwpOiBib29sZWFuIHtcclxuICAgIHJldHVybiBCb29sZWFuKFxyXG4gICAgICBjYXRlZ29yaWVzXHJcbiAgICAgICAgPy5zcGxpdCgnLCcpXHJcbiAgICAgICAgLmV2ZXJ5KFxyXG4gICAgICAgICAgY2F0ZWdvcnkgPT5cclxuICAgICAgICAgICAgd2luZG93Ll9fTVNGVF9TREsuU3RvcmUuZ2V0dGVycy51c2VyQ29uc2VudD8ucHJlZmVyZW5jZXNbXHJcbiAgICAgICAgICAgICAgY2F0ZWdvcnlcclxuICAgICAgICAgICAgXSA9PT0gUHJlZmVyZW5jZS5PTixcclxuICAgICAgICApLFxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgQmxvY2tpbmdTZXJ2aWNlVXRpbCB9IGZyb20gJy4vQmxvY2tpbmdTZXJ2aWNlVXRpbCc7XHJcblxyXG5leHBvcnQgY2xhc3MgQmxvY2tpbmdTZXJ2aWNlIHtcclxuICBwcml2YXRlIGRvbU9ic2VydmVyOiBNdXRhdGlvbk9ic2VydmVyIHwgbnVsbCA9IG51bGw7XHJcblxyXG4gIHByaXZhdGUgc3RhdGljIG11dGF0aW9uQ2FsbGJhY2sobXV0YXRpb25SZWNvcmRzOiBNdXRhdGlvblJlY29yZFtdKTogdm9pZCB7XHJcbiAgICBtdXRhdGlvblJlY29yZHMuZm9yRWFjaChtdXRhdGlvblJlY29yZCA9PiB7XHJcbiAgICAgIG11dGF0aW9uUmVjb3JkLmFkZGVkTm9kZXMuZm9yRWFjaChhZGRlZE5vZGUgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIGFkZGVkTm9kZS5ub2RlVHlwZSA9PT0gMSAmJlxyXG4gICAgICAgICAgICAoPEhUTUxFbGVtZW50PmFkZGVkTm9kZSkuaGFzQXR0cmlidXRlKFxyXG4gICAgICAgICAgICAgIEJsb2NraW5nU2VydmljZVV0aWwuTVNGVF9DT05TRU5UX0lHTk9SRV9BVFRSSUJVVEUsXHJcbiAgICAgICAgICAgICkgPT09IGZhbHNlXHJcbiAgICAgICAgICApIHtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgIGFkZGVkTm9kZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PVxyXG4gICAgICAgICAgICAgIHdpbmRvdy5fX01TRlRfU0RLLmVudW1zLlJlZ2lzdGVyZWREaXZUeXBlLlNjcmlwdFxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICBCbG9ja2luZ1NlcnZpY2Uuc2NyaXB0TXV0YXRpb25PYnNlcnZlcihcclxuICAgICAgICAgICAgICAgIDxIVE1MU2NyaXB0RWxlbWVudD5hZGRlZE5vZGUsXHJcbiAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChcclxuICAgICAgICAgICAgICBhZGRlZE5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT1cclxuICAgICAgICAgICAgICB3aW5kb3cuX19NU0ZUX1NESy5lbnVtcy5SZWdpc3RlcmVkRGl2VHlwZS5JRnJhbWVcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgQmxvY2tpbmdTZXJ2aWNlLmlmcmFtZU11dGF0aW9uT2JzZXJ2ZXIoXHJcbiAgICAgICAgICAgICAgICA8SFRNTElGcmFtZUVsZW1lbnQ+YWRkZWROb2RlLFxyXG4gICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgY29uc29sZS53YXJuKFxyXG4gICAgICAgICAgICAnRmFpbGVkIHRvIGJsb2NrIHRoZSBub2RlICcsXHJcbiAgICAgICAgICAgIGFkZGVkTm9kZS5ub2RlTmFtZSxcclxuICAgICAgICAgICAgJ3dpdGggZXJyb3IgJyxcclxuICAgICAgICAgICAgZXJyb3IsXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgICAgd2luZG93Ll9fTVNGVF9TREsuTG9nZ2VyLndhcm4oXHJcbiAgICAgICAgICAgICdGYWlsZWQgdG8gYmxvY2sgdGFnICcgKyBhZGRlZE5vZGUubm9kZU5hbWUsXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc3RhdGljIHNjcmlwdE11dGF0aW9uT2JzZXJ2ZXIoc2NyaXB0Tm9kZTogSFRNTFNjcmlwdEVsZW1lbnQpOiB2b2lkIHtcclxuICAgIGNvbnN0IHR5cGUgPSBzY3JpcHROb2RlLnR5cGU7XHJcbiAgICBjb25zdCBtc2Z0Q29uc2VudENhdGVnb3JpZXMgPSBzY3JpcHROb2RlLmdldEF0dHJpYnV0ZShcclxuICAgICAgQmxvY2tpbmdTZXJ2aWNlVXRpbC5NU0ZUX0NPTlNFTlRfQ0FURUdPUklFU19BVFRSSUJVVEUsXHJcbiAgICApO1xyXG5cclxuICAgIGlmIChCbG9ja2luZ1NlcnZpY2VVdGlsLnNob3VsZEJsb2NrVHJhY2tlclNvdXJjZShtc2Z0Q29uc2VudENhdGVnb3JpZXMpKSB7XHJcbiAgICAgIHdpbmRvdy5fX01TRlRfU0RLLkxvZ2dlci5pbmZvKCdCbG9ja2luZyBzY3JpcHQgJyArIHNjcmlwdE5vZGUuc3JjKTtcclxuXHJcbiAgICAgIGlmIChcclxuICAgICAgICAhc2NyaXB0Tm9kZS5oYXNBdHRyaWJ1dGUoXHJcbiAgICAgICAgICBCbG9ja2luZ1NlcnZpY2VVdGlsLk1TRlRfVFJBQ0tFUl9FWEVDVVRJT05fQVRUUklCVVRFLFxyXG4gICAgICAgIClcclxuICAgICAgKSB7XHJcbiAgICAgICAgc2NyaXB0Tm9kZS5zZXRBdHRyaWJ1dGUoXHJcbiAgICAgICAgICBCbG9ja2luZ1NlcnZpY2VVdGlsLk1TRlRfUE9TVF9DT05TRU5UX1NDUklQVF9UWVBFX0FUVFJJQlVURSxcclxuICAgICAgICAgIHR5cGUsXHJcbiAgICAgICAgKTtcclxuICAgICAgICBzY3JpcHROb2RlLnNldEF0dHJpYnV0ZShcclxuICAgICAgICAgIEJsb2NraW5nU2VydmljZVV0aWwuU0NSSVBUX1RZUEVfQVRUUklCVVRFLFxyXG4gICAgICAgICAgQmxvY2tpbmdTZXJ2aWNlVXRpbC5TQ1JJUFRfQkxPQ0tJTkdfVFlQRV9BVFRSSUJVVEVfVkFMVUUsXHJcbiAgICAgICAgKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEZpcmVmb3ggaGFzIHRoaXMgYWRkaXRpb25hbCBldmVudCB3aGljaCBwcmV2ZW50cyBzY3JpcHRzIGZyb20gYmVpbmcgZXhlY3V0ZWRcclxuICAgIGNvbnN0IGJlZm9yZVNjcmlwdEV4ZWN1dGVMaXN0ZW5lciA9IGZ1bmN0aW9uIChldmVudDogYW55KSB7XHJcbiAgICAgIC8vIFByZXZlbnQgb25seSBtYXJrZWQgc2NyaXB0cyBmcm9tIGV4ZWN1dGluZ1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgc2NyaXB0Tm9kZS5nZXRBdHRyaWJ1dGUoQmxvY2tpbmdTZXJ2aWNlVXRpbC5TQ1JJUFRfVFlQRV9BVFRSSUJVVEUpID09PVxyXG4gICAgICAgIEJsb2NraW5nU2VydmljZVV0aWwuU0NSSVBUX0JMT0NLSU5HX1RZUEVfQVRUUklCVVRFX1ZBTFVFXHJcbiAgICAgIClcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBzY3JpcHROb2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXHJcbiAgICAgICAgJ2JlZm9yZXNjcmlwdGV4ZWN1dGUnLFxyXG4gICAgICAgIGJlZm9yZVNjcmlwdEV4ZWN1dGVMaXN0ZW5lcixcclxuICAgICAgKTtcclxuICAgIH07XHJcbiAgICBzY3JpcHROb2RlLmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgICdiZWZvcmVzY3JpcHRleGVjdXRlJyxcclxuICAgICAgYmVmb3JlU2NyaXB0RXhlY3V0ZUxpc3RlbmVyLFxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc3RhdGljIGlmcmFtZU11dGF0aW9uT2JzZXJ2ZXIoaWZyYW1lTm9kZTogSFRNTElGcmFtZUVsZW1lbnQpOiB2b2lkIHtcclxuICAgIGNvbnN0IHNyYyA9IGlmcmFtZU5vZGUuc3JjO1xyXG4gICAgY29uc3QgbXNmdENvbnNlbnRDYXRlZ29yaWVzID0gaWZyYW1lTm9kZS5nZXRBdHRyaWJ1dGUoXHJcbiAgICAgIEJsb2NraW5nU2VydmljZVV0aWwuTVNGVF9DT05TRU5UX0NBVEVHT1JJRVNfQVRUUklCVVRFLFxyXG4gICAgKTtcclxuXHJcbiAgICBpZiAoQmxvY2tpbmdTZXJ2aWNlVXRpbC5zaG91bGRCbG9ja1RyYWNrZXJTb3VyY2UobXNmdENvbnNlbnRDYXRlZ29yaWVzKSkge1xyXG4gICAgICB3aW5kb3cuX19NU0ZUX1NESy5Mb2dnZXIuaW5mbygnQmxvY2tpbmcgaWZyYW1lICcgKyBpZnJhbWVOb2RlLnNyYyk7XHJcblxyXG4gICAgICBpZnJhbWVOb2RlLnJlbW92ZUF0dHJpYnV0ZShCbG9ja2luZ1NlcnZpY2VVdGlsLlNSQ19BVFRSSUJVVEUpO1xyXG4gICAgICBpZnJhbWVOb2RlLnNldEF0dHJpYnV0ZShCbG9ja2luZ1NlcnZpY2VVdGlsLkRBVEFTRVRfU1JDX0FUVFJJQlVURSwgc3JjKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgc3RhdGljIHVuYmxvY2soKTogdm9pZCB7XHJcbiAgICB3aW5kb3cuX19NU0ZUX1NESy5Mb2dnZXIuaW5mbygnVHJhY2tlciBCbG9ja2luZyB1bmJsb2NrIGlzIHN0YXJ0ZWQnKTtcclxuICAgIEJsb2NraW5nU2VydmljZS51bmJsb2NrU2NyaXB0cygpO1xyXG4gICAgQmxvY2tpbmdTZXJ2aWNlLnVuYmxvY2tJRnJhbWVzKCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHN0YXRpYyB1bmJsb2NrU2NyaXB0cygpOiB2b2lkIHtcclxuICAgIGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yQWxsKFxyXG4gICAgICAgIGBzY3JpcHRbJHtCbG9ja2luZ1NlcnZpY2VVdGlsLk1TRlRfQ09OU0VOVF9DQVRFR09SSUVTX0FUVFJJQlVURX1dWyR7QmxvY2tpbmdTZXJ2aWNlVXRpbC5TQ1JJUFRfVFlQRV9BVFRSSUJVVEV9PVwiJHtCbG9ja2luZ1NlcnZpY2VVdGlsLlNDUklQVF9CTE9DS0lOR19UWVBFX0FUVFJJQlVURV9WQUxVRX1cIl06bm90KFske0Jsb2NraW5nU2VydmljZVV0aWwuTVNGVF9DT05TRU5UX0NBVEVHT1JJRVNfQVRUUklCVVRFfT1cIlwiXSlgLFxyXG4gICAgICApXHJcbiAgICAgIC5mb3JFYWNoKGJsb2NrZWROb2RlID0+IHtcclxuICAgICAgICBjb25zdCBzY3JpcHROb2RlID0gPEhUTUxTY3JpcHRFbGVtZW50PmJsb2NrZWROb2RlO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBjb25zdCBjb25zZW50Q2F0ZWdvcmllcyA9IHNjcmlwdE5vZGUuZ2V0QXR0cmlidXRlKFxyXG4gICAgICAgICAgICBCbG9ja2luZ1NlcnZpY2VVdGlsLk1TRlRfQ09OU0VOVF9DQVRFR09SSUVTX0FUVFJJQlVURSxcclxuICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgY29uc3Qgc2hvdWxkVW5ibG9ja1RyYWNrZXJTb3VyY2UgPVxyXG4gICAgICAgICAgICBCbG9ja2luZ1NlcnZpY2VVdGlsLnNob3VsZFVuYmxvY2tUcmFja2VyU291cmNlKGNvbnNlbnRDYXRlZ29yaWVzKTtcclxuXHJcbiAgICAgICAgICBpZiAoc2hvdWxkVW5ibG9ja1RyYWNrZXJTb3VyY2UpIHtcclxuICAgICAgICAgICAgd2luZG93Ll9fTVNGVF9TREsuTG9nZ2VyLmluZm8oXHJcbiAgICAgICAgICAgICAgJ1VuYmxvY2tpbmcgc2NyaXB0ICcgKyBzY3JpcHROb2RlLnNyYyxcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgIGxldCB0eXBlVmFsdWUgPSBzY3JpcHROb2RlLmdldEF0dHJpYnV0ZShcclxuICAgICAgICAgICAgICBCbG9ja2luZ1NlcnZpY2VVdGlsLk1TRlRfUE9TVF9DT05TRU5UX1NDUklQVF9UWVBFX0FUVFJJQlVURSxcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgdHlwZVZhbHVlID1cclxuICAgICAgICAgICAgICB0eXBlVmFsdWUgIT0gbnVsbCA/IHR5cGVWYWx1ZSA6ICdhcHBsaWNhdGlvbi9qYXZhc2NyaXB0JztcclxuICAgICAgICAgICAgY29uc3QgcGFyZW50Tm9kZSA9IHNjcmlwdE5vZGUucGFyZW50Tm9kZTtcclxuICAgICAgICAgICAgcGFyZW50Tm9kZT8ucmVtb3ZlQ2hpbGQoc2NyaXB0Tm9kZSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBuZXdOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2NyaXB0Tm9kZS5hdHRyaWJ1dGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlID0gc2NyaXB0Tm9kZS5hdHRyaWJ1dGVzW2ldO1xyXG4gICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUubmFtZSAhPT0gJ3R5cGUnKSB7XHJcbiAgICAgICAgICAgICAgICBuZXdOb2RlLnNldEF0dHJpYnV0ZShcclxuICAgICAgICAgICAgICAgICAgYXR0cmlidXRlLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgIHNjcmlwdE5vZGUuYXR0cmlidXRlc1tpXS52YWx1ZSxcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG5ld05vZGUuc2V0QXR0cmlidXRlKFxyXG4gICAgICAgICAgICAgICAgICBCbG9ja2luZ1NlcnZpY2VVdGlsLlNDUklQVF9UWVBFX0FUVFJJQlVURSxcclxuICAgICAgICAgICAgICAgICAgdHlwZVZhbHVlLFxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG5ld05vZGUuc2V0QXR0cmlidXRlKFxyXG4gICAgICAgICAgICAgIEJsb2NraW5nU2VydmljZVV0aWwuTVNGVF9UUkFDS0VSX0VYRUNVVElPTl9BVFRSSUJVVEUsXHJcbiAgICAgICAgICAgICAgJ3RydWUnLFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBuZXdOb2RlLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHNjcmlwdE5vZGUuaW5uZXJIVE1MKSk7XHJcbiAgICAgICAgICAgIHBhcmVudE5vZGUgPT0gbnVsbFxyXG4gICAgICAgICAgICAgID8gZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChuZXdOb2RlKVxyXG4gICAgICAgICAgICAgIDogcGFyZW50Tm9kZS5hcHBlbmRDaGlsZChuZXdOb2RlKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5fX01TRlRfU0RLLkxvZ2dlci5pbmZvKFxyXG4gICAgICAgICAgICAgIGBOb3QgVW5ibG9ja2luZyBzY3JpcHQgJHtzY3JpcHROb2RlLnNyY30gYXMgY29uc2VudCBub3QgZ2l2ZW5gLFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICB3aW5kb3cuX19NU0ZUX1NESy5Mb2dnZXIuaW5mbyhcclxuICAgICAgICAgICAgYEZhaWxlZCB0byB1bmJsb2NrIHNjcmlwdCAke3NjcmlwdE5vZGUuc3JjfWAsXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHN0YXRpYyB1bmJsb2NrSUZyYW1lcygpOiB2b2lkIHtcclxuICAgIGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yQWxsKFxyXG4gICAgICAgIGBpZnJhbWVbJHtCbG9ja2luZ1NlcnZpY2VVdGlsLk1TRlRfQ09OU0VOVF9DQVRFR09SSUVTX0FUVFJJQlVURX1dWyR7QmxvY2tpbmdTZXJ2aWNlVXRpbC5EQVRBU0VUX1NSQ19BVFRSSUJVVEV9XTpub3QoWyR7QmxvY2tpbmdTZXJ2aWNlVXRpbC5NU0ZUX0NPTlNFTlRfQ0FURUdPUklFU19BVFRSSUJVVEV9PVwiXCJdWyR7QmxvY2tpbmdTZXJ2aWNlVXRpbC5EQVRBU0VUX1NSQ19BVFRSSUJVVEV9PVwiXCJdKWAsXHJcbiAgICAgIClcclxuICAgICAgLmZvckVhY2goYmxvY2tlZE5vZGUgPT4ge1xyXG4gICAgICAgIGNvbnN0IGlmcmFtZU5vZGUgPSA8SFRNTElGcmFtZUVsZW1lbnQ+YmxvY2tlZE5vZGU7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGNvbnN0IGNvbnNlbnRDYXRlZ29yaWVzID0gaWZyYW1lTm9kZS5nZXRBdHRyaWJ1dGUoXHJcbiAgICAgICAgICAgIEJsb2NraW5nU2VydmljZVV0aWwuTVNGVF9DT05TRU5UX0NBVEVHT1JJRVNfQVRUUklCVVRFLFxyXG4gICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICBjb25zdCBzaG91bGRVbmJsb2NrVHJhY2tlclNvdXJjZSA9XHJcbiAgICAgICAgICAgIEJsb2NraW5nU2VydmljZVV0aWwuc2hvdWxkVW5ibG9ja1RyYWNrZXJTb3VyY2UoY29uc2VudENhdGVnb3JpZXMpO1xyXG5cclxuICAgICAgICAgIGlmIChzaG91bGRVbmJsb2NrVHJhY2tlclNvdXJjZSkge1xyXG4gICAgICAgICAgICB3aW5kb3cuX19NU0ZUX1NESy5Mb2dnZXIuaW5mbyhcclxuICAgICAgICAgICAgICAnVW5ibG9ja2luZyBpZnJhbWUgJyArIGlmcmFtZU5vZGUuc3JjLFxyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcGFyZW50Tm9kZSA9IGlmcmFtZU5vZGUucGFyZW50Tm9kZTtcclxuICAgICAgICAgICAgcGFyZW50Tm9kZT8ucmVtb3ZlQ2hpbGQoaWZyYW1lTm9kZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld05vZGUgPSA8SFRNTElGcmFtZUVsZW1lbnQ+aWZyYW1lTm9kZS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICAgICAgICAgIGxldCBkYXRhc3JjID0gbmV3Tm9kZS5nZXRBdHRyaWJ1dGUoXHJcbiAgICAgICAgICAgICAgQmxvY2tpbmdTZXJ2aWNlVXRpbC5EQVRBU0VUX1NSQ19BVFRSSUJVVEUsXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGRhdGFzcmMgPSBkYXRhc3JjICE9PSBudWxsID8gZGF0YXNyYyA6ICcnO1xyXG4gICAgICAgICAgICBuZXdOb2RlLnNldEF0dHJpYnV0ZShCbG9ja2luZ1NlcnZpY2VVdGlsLlNSQ19BVFRSSUJVVEUsIGRhdGFzcmMpO1xyXG4gICAgICAgICAgICBuZXdOb2RlLnNldEF0dHJpYnV0ZShcclxuICAgICAgICAgICAgICBCbG9ja2luZ1NlcnZpY2VVdGlsLk1TRlRfVFJBQ0tFUl9FWEVDVVRJT05fQVRUUklCVVRFLFxyXG4gICAgICAgICAgICAgICd0cnVlJyxcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgbmV3Tm9kZS5yZW1vdmVBdHRyaWJ1dGUoQmxvY2tpbmdTZXJ2aWNlVXRpbC5EQVRBU0VUX1NSQ19BVFRSSUJVVEUpO1xyXG4gICAgICAgICAgICBwYXJlbnROb2RlID09IG51bGxcclxuICAgICAgICAgICAgICA/IGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQobmV3Tm9kZSlcclxuICAgICAgICAgICAgICA6IHBhcmVudE5vZGUuYXBwZW5kQ2hpbGQobmV3Tm9kZSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB3aW5kb3cuX19NU0ZUX1NESy5Mb2dnZXIuaW5mbyhcclxuICAgICAgICAgICAgICBgTm90IFVuYmxvY2tpbmcgaWZyYW1lICR7aWZyYW1lTm9kZS5zcmN9IGFzIGNvbnNlbnQgbm90IGdpdmVuYCxcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgd2luZG93Ll9fTVNGVF9TREsuTG9nZ2VyLmluZm8oXHJcbiAgICAgICAgICAgIGBGYWlsZWQgdG8gdW5ibG9jayBpZnJhbWUgJHtpZnJhbWVOb2RlLnNyY31gLFxyXG4gICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXJ0KGVuYWJsZU11dGF0aW9uT2JzZXJ2ZXI6IGJvb2xlYW4pIHtcclxuICAgIHdpbmRvdy5fX01TRlRfU0RLLkV2ZW50QnVzLm9uKFxyXG4gICAgICB3aW5kb3cuX19NU0ZUX1NESy5lbnVtcy5QdWJsaWNFdmVudHMuQ29uc2VudENoYW5nZWQsXHJcbiAgICAgIEJsb2NraW5nU2VydmljZS51bmJsb2NrLFxyXG4gICAgKTtcclxuICAgIHRoaXMuZG9tT2JzZXJ2ZXIgPSBudWxsO1xyXG4gICAgaWYgKGVuYWJsZU11dGF0aW9uT2JzZXJ2ZXIpIHtcclxuICAgICAgdGhpcy5kb21PYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKFxyXG4gICAgICAgIChtdXRhdGlvblJlY29yZHM6IE11dGF0aW9uUmVjb3JkW10pID0+XHJcbiAgICAgICAgICBCbG9ja2luZ1NlcnZpY2UubXV0YXRpb25DYWxsYmFjayhtdXRhdGlvblJlY29yZHMpLFxyXG4gICAgICApO1xyXG4gICAgICB0aGlzLmRvbU9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCB7XHJcbiAgICAgICAgY2hpbGRMaXN0OiB0cnVlLFxyXG4gICAgICAgIHN1YnRyZWU6IHRydWUsXHJcbiAgICAgIH0pO1xyXG4gICAgICB3aW5kb3cuX19NU0ZUX1NESy5Mb2dnZXIuaW5mbygnU3RhcnRlZCB0cmFja2VyIGJsb2NraW5nIHNlcnZpY2UnKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBCbG9ja2luZ1NlcnZpY2VJbnN0YW5jZSA9IG5ldyBCbG9ja2luZ1NlcnZpY2UoKTtcclxuIiwiaW1wb3J0IHsgQmxvY2tpbmdTZXJ2aWNlSW5zdGFuY2UsIEJsb2NraW5nU2VydmljZSB9IGZyb20gJy4uL0Jsb2NraW5nU2VydmljZSc7XHJcblxyXG5leHBvcnQgY2xhc3MgUHVibGljQVBJIHtcclxuICBwdWJsaWMgc3RhdGljIGdldEJsb2NraW5nU2VydmljZSgpOiBCbG9ja2luZ1NlcnZpY2Uge1xyXG4gICAgcmV0dXJuIEJsb2NraW5nU2VydmljZUluc3RhbmNlO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBQdWJsaWNBUEkgfSBmcm9tICcuL3B1YmxpY0FwaSc7XHJcbndpbmRvdy5fX01TRlRfU0RLLkhlbHBlcnMuQWRkUHVibGljQXBpcyhQdWJsaWNBUEkpO1xyXG53aW5kb3cuX19NU0ZUX1NESy5IZWxwZXJzLmV4cG9zZUFwaXMoKTtcclxuXHJcbmlmIChcclxuICB3aW5kb3cuX19NU0ZUX1NESy5TdG9yZS5nZXR0ZXJzLnBhY2thZ2VDb25maWd1cmF0aW9uc1xyXG4gICAgLmlzVHJhY2tlckJsb2NraW5nRW5hYmxlZCA/P1xyXG4gIHRydWVcclxuKSB7XHJcbiAgUHVibGljQVBJLmdldEJsb2NraW5nU2VydmljZSgpLnN0YXJ0KHRydWUpO1xyXG59XHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7SUFBQSxJQUFZLGdCQUdYO0lBSEQsV0FBWSxnQkFBZ0I7UUFDMUIseUNBQXFCLENBQUE7UUFDckIseUNBQXFCLENBQUE7SUFDdkIsQ0FBQyxFQUhXLGdCQUFnQixLQUFoQixnQkFBZ0IsUUFHM0I7SUFFRCxJQUFZLFlBZ0JYO0lBaEJELFdBQVksWUFBWTtRQUN0QixpREFBaUMsQ0FBQTtRQUNqQyx1REFBdUMsQ0FBQTtRQUN2QywrQ0FBK0IsQ0FBQTtRQUMvQix5REFBeUMsQ0FBQTtRQUN6Qyx1Q0FBdUIsQ0FBQTtRQUN2Qix1Q0FBdUIsQ0FBQTtRQUN2Qiw2Q0FBNkIsQ0FBQTtRQUM3QiwrQ0FBK0IsQ0FBQTtRQUMvQiwrQ0FBK0IsQ0FBQTtRQUMvQixxREFBcUMsQ0FBQTtRQUNyQywyQ0FBMkIsQ0FBQTtRQUMzQix5RkFBeUUsQ0FBQTtRQUN6RSwyREFBMkMsQ0FBQTtRQUMzQyxtREFBbUMsQ0FBQTtRQUNuQywyREFBMkMsQ0FBQTtJQUM3QyxDQUFDLEVBaEJXLFlBQVksS0FBWixZQUFZLFFBZ0J2QjtJQUVELElBQVksTUFJWDtJQUpELFdBQVksTUFBTTtRQUNoQix1QkFBYSxDQUFBO1FBQ2IsK0RBQXFELENBQUE7UUFDckQscUNBQTJCLENBQUE7SUFDN0IsQ0FBQyxFQUpXLE1BQU0sS0FBTixNQUFNLFFB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
